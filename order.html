<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Order homemade food products from Kalindi - Anjali Gruh Udyog. Browse our delicious chutneys, laddus, and spice mixes.">
    <title id="pageTitle">Order Now - Kalindi Anjali Gruh Udyog</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'heritage': {
                            '50': '#faf6f0',
                            '100': '#f4ecdd',
                            '200': '#e8d7b9',
                            '300': '#dabb8b',
                            '400': '#cb9759',
                            '500': '#b17e4f', // Primary brand color
                            '600': '#9d6b42',
                            '700': '#7f5437',
                            '800': '#684530',
                            '900': '#573b2a',
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'],
                        'display': ['"Playfair Display"', 'serif']
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideInUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    },
                    animation: {
                        fadeIn: 'fadeIn 0.5s ease-out forwards',
                        slideInUp: 'slideInUp 0.5s ease-out forwards',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f4;
            color: #333;
        }
        .text-display {
            font-family: '"Playfair Display"', serif;
        }
        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        #languageModal.active {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
    <header class="bg-heritage-700 text-white p-4 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-display font-bold" id="brandName">Kalindi - Anjali Gruh Udyog</h1>
            <nav>
                <button onclick="window.location.href='index.html'" class="bg-heritage-500 hover:bg-heritage-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out" id="backToHomeBtn">Back to Home</button>
                <button onclick="showCart()" class="bg-heritage-500 hover:bg-heritage-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out ml-2" id="viewCartBtn">View Cart (<span id="cartItemCount">0</span>)</button>
            </nav>
        </div>
    </header>

    <main class="container mx-auto p-4 flex-grow">
        <section id="productListSection" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 py-8">
            </section>

        <section id="cartSection" class="hidden bg-white p-6 rounded-lg shadow-lg animate-fadeIn">
            <h2 class="text-3xl font-display font-bold text-center mb-6" id="cartTitle">Your Cart</h2>
            <div id="cartItems" class="space-y-4">
                </div>
            <div class="flex justify-between items-center mt-8 pt-4 border-t border-gray-200">
                <p class="text-xl font-bold" id="totalAmountText">Total: ₹<span id="totalAmount">0</span></p>
                <div>
                    <button onclick="cancelCheckout()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out mr-2" id="continueShoppingBtn">Continue Shopping</button>
                    <button onclick="showCheckout()" class="bg-heritage-600 hover:bg-heritage-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out" id="proceedToCheckoutBtn">Proceed to Checkout</button>
                </div>
            </div>
        </section>

        <section id="checkoutSection" class="hidden bg-white p-6 rounded-lg shadow-lg animate-fadeIn">
            <h2 class="text-3xl font-display font-bold text-center mb-6" id="checkoutTitle">Checkout Details</h2>
            <form id="checkoutForm" class="space-y-4">
                <div>
                    <label for="fullName" class="block text-gray-700 text-sm font-bold mb-2" id="fullNameLabel">Full Name:</label>
                    <input type="text" id="fullName" name="fullName" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                </div>
                <div>
                    <label for="phone" class="block text-gray-700 text-sm font-bold mb-2" id="phoneLabel">WhatsApp Phone Number:</label>
                    <input type="tel" id="phone" name="phone" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required pattern="[0-9]{10,15}" title="Please enter a valid phone number (10-15 digits)">
                </div>
                <div>
                    <label for="email" class="block text-gray-700 text-sm font-bold mb-2" id="emailLabel">Email (Optional):</label>
                    <input type="email" id="email" name="email" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div>
                    <label for="address" class="block text-gray-700 text-sm font-bold mb-2" id="addressLabel">Delivery Address:</label>
                    <textarea id="address" name="address" rows="4" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required></textarea>
                </div>
                <div>
                    <label for="deliveryInstructions" class="block text-gray-700 text-sm font-bold mb-2" id="deliveryInstructionsLabel">Delivery Instructions (Optional):</label>
                    <textarea id="deliveryInstructions" name="deliveryInstructions" rows="2" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" id="shippingMethodLabel">Shipping Method:</label>
                    <div>
                        <input type="radio" id="standardShipping" name="shipping" value="Standard Shipping (3-5 days)" data-cost="50" class="mr-2" checked>
                        <label for="standardShipping" id="standardShippingText">Standard Shipping (3-5 days) - ₹50</label>
                    </div>
                    <div>
                        <input type="radio" id="expressShipping" name="shipping" value="Express Shipping (1-2 days)" data-cost="100" class="mr-2">
                        <label for="expressShipping" id="expressShippingText">Express Shipping (1-2 days) - ₹100</label>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" id="paymentMethodLabel">Payment Method:</label>
                    <div>
                        <input type="radio" id="cod" name="payment" value="Cash on Delivery" class="mr-2" checked>
                        <label for="cod" id="codText">Cash on Delivery (COD)</label>
                    </div>
                    <div>
                        <input type="radio" id="onlinePayment" name="payment" value="UPI / Online Payment" class="mr-2">
                        <label for="onlinePayment" id="onlinePaymentText">UPI / Online Payment</label>
                    </div>
                </div>

                <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                    <button type="button" onclick="showCart()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out" id="backToCartBtn">Back to Cart</button>
                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out" id="confirmOrderBtn">Confirm Order on WhatsApp</button>
                </div>
            </form>
        </section>
    </main>

    <footer class="bg-heritage-800 text-white p-4 text-center mt-8">
        <p>&copy; <span id="currentYear"></span> Kalindi - Anjali Gruh Udyog. All rights reserved.</p>
    </footer>

    <script>
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let translations = {};
        let currentLanguage = 'en';

        // Translations object (expanded for more products and details)
        const allTranslations = {
            en: {
                brandName: "Kalindi - Anjali Gruh Udyog",
                pageTitle: "Order Now - Kalindi Anjali Gruh Udyog",
                backToHomeBtn: "Back to Home",
                viewCartBtn: "View Cart",
                cartTitle: "Your Cart",
                totalAmountText: "Total:",
                continueShoppingBtn: "Continue Shopping",
                proceedToCheckoutBtn: "Proceed to Checkout",
                checkoutTitle: "Checkout Details",
                fullNameLabel: "Full Name:",
                phoneLabel: "WhatsApp Phone Number:",
                emailLabel: "Email (Optional):",
                addressLabel: "Delivery Address:",
                deliveryInstructionsLabel: "Delivery Instructions (Optional):",
                shippingMethodLabel: "Shipping Method:",
                standardShippingText: "Standard Shipping (3-5 days) - ₹50",
                expressShippingText: "Express Shipping (1-2 days) - ₹100",
                paymentMethodLabel: "Payment Method:",
                codText: "Cash on Delivery (COD)",
                onlinePaymentText: "UPI / Online Payment",
                backToCartBtn: "Back to Cart",
                confirmOrderBtn: "Confirm Order on WhatsApp",
                removeBtn: "Remove",
                emptyCartMessage: "Your cart is empty.",
                quantityLabel: "Qty:",
                whatsappOrderSubject: "New Order from Website",
                thankYouMessage: "Thank you for your order! We will contact you shortly.",
                productNotFound: "Product not found.",
                products: [
                    {
                        id: 1,
                        name: "Kothambir Wadi (New)",
                        description: "Authentic Maharashtrian snack, crispy and flavorful.",
                        image: "http://googleusercontent.com/img/kothambir-wadi.jpg",
                        price: 150, // Per piece or 250gm pack, define clearly
                        unit: "250gm",
                        isNew: true
                    },
                    {
                        id: 2,
                        name: "Tilgul Ladoo",
                        description: "Traditional sesame and jaggery ladoo, perfect for festive occasions.",
                        image: "http://googleusercontent.com/img/tilgul-ladoo.jpg",
                        price: 200,
                        unit: "250gm",
                        isNew: false
                    },
                    {
                        id: 3,
                        name: "Besan Ladoo",
                        description: "Melt-in-mouth gram flour sweets.",
                        image: "http://googleusercontent.com/img/besan-ladoo.jpg",
                        price: 220,
                        unit: "250gm",
                        isNew: false
                    },
                    {
                        id: 4,
                        name: "Chivda",
                        description: "Spicy and crunchy snack mix.",
                        image: "http://googleusercontent.com/img/chivda.jpg",
                        price: 180,
                        unit: "500gm",
                        isNew: false
                    },
                    {
                        id: 5,
                        name: "Shev Bhaji Masala",
                        description: "Ready-to-use spice blend for Shev Bhaji.",
                        image: "http://googleusercontent.com/img/shev-bhaji-masala.jpg",
                        price: 90,
                        unit: "100gm",
                        isNew: false
                    },
                    {
                        id: 6,
                        name: "Thalipeeth Bhajani",
                        description: "Multigrain flour mix for traditional Thalipeeth.",
                        image: "http://googleusercontent.com/img/thalipeeth-bhajani.jpg",
                        price: 110,
                        unit: "250gm",
                        isNew: false
                    },
                    {
                        id: 7,
                        name: "Puran Poli (Seasonal)",
                        description: "Sweet flatbread with lentil filling, available seasonally.",
                        image: "http://googleusercontent.com/img/puran-poli.jpg",
                        price: 35, // Per piece
                        unit: "per piece",
                        isNew: false
                    },
                    {
                        id: 8,
                        name: "Ambe Dal",
                        description: "Raw mango and chana dal salad.",
                        image: "http://googleusercontent.com/img/ambe-dal.jpg",
                        price: 70,
                        unit: "200gm",
                        isNew: false
                    },
                ]
            },
            hi: {
                brandName: "काल हिंदी - अंजलि गृह उद्योग",
                pageTitle: "अभी ऑर्डर करें - अंजलि गृह उद्योग",
                backToHomeBtn: "होम पर वापस जाएँ",
                viewCartBtn: "कार्ट देखें",
                cartTitle: "आपका कार्ट",
                totalAmountText: "कुल:",
                continueShoppingBtn: "खरीददारी जारी रखें",
                proceedToCheckoutBtn: "चेकआउट के लिए आगे बढ़ें",
                checkoutTitle: "चेकआउट विवरण",
                fullNameLabel: "पूरा नाम:",
                phoneLabel: "व्हाट्सएप फोन नंबर:",
                emailLabel: "ईमेल (वैकल्पिक):",
                addressLabel: "वितरण पता:",
                deliveryInstructionsLabel: "वितरण निर्देश (वैकल्पिक):",
                shippingMethodLabel: "शिपिंग विधि:",
                standardShippingText: "मानक शिपिंग (3-5 दिन) - ₹50",
                expressShippingText: "एक्सप्रेस शिपिंग (1-2 दिन) - ₹100",
                paymentMethodLabel: "भुगतान विधि:",
                codText: "कैश ऑन डिलीवरी (COD)",
                onlinePaymentText: "यूपीआई / ऑनलाइन भुगतान",
                backToCartBtn: "कार्ट पर वापस जाएँ",
                confirmOrderBtn: "व्हाट्सएप पर ऑर्डर पुष्टि करें",
                removeBtn: "हटाएँ",
                emptyCartMessage: "आपका कार्ट खाली है।",
                quantityLabel: "मात्रा:",
                whatsappOrderSubject: "वेबसाइट से नया ऑर्डर",
                thankYouMessage: "आपके ऑर्डर के लिए धन्यवाद! हम शीघ्र ही आपसे संपर्क करेंगे।",
                productNotFound: "उत्पाद नहीं मिला।",
                products: [
                    {
                        id: 1,
                        name: "कोथिंबीर वड़ी (नया)",
                        description: "प्रामाणिक महाराष्ट्रीयन स्नैक, कुरकुरा और स्वादिष्ट।",
                        image: "http://googleusercontent.com/img/kothambir-wadi.jpg",
                        price: 150,
                        unit: "250ग्राम",
                        isNew: true
                    },
                    {
                        id: 2,
                        name: "तिल गुल लाडू",
                        description: "पारंपरिक तिल और गुड़ का लाडू, त्योहारों के लिए एकदम सही।",
                        image: "http://googleusercontent.com/img/tilgul-ladoo.jpg",
                        price: 200,
                        unit: "250ग्राम",
                        isNew: false
                    },
                    {
                        id: 3,
                        name: "बेसन लाडू",
                        description: "मुंह में घुल जाने वाली बेसन की मिठाई।",
                        image: "http://googleusercontent.com/img/besan-ladoo.jpg",
                        price: 220,
                        unit: "250ग्राम",
                        isNew: false
                    },
                    {
                        id: 4,
                        name: "चिवड़ा",
                        description: "मसालेदार और कुरकुरा स्नैक मिक्स।",
                        image: "http://googleusercontent.com/img/chivda.jpg",
                        price: 180,
                        unit: "500ग्राम",
                        isNew: false
                    },
                    {
                        id: 5,
                        name: "शेव भाजी मसाला",
                        description: "शेव भाजी के लिए तैयार मसाला मिश्रण।",
                        image: "http://googleusercontent.com/img/shev-bhaji-masala.jpg",
                        price: 90,
                        unit: "100ग्राम",
                        isNew: false
                    },
                    {
                        id: 6,
                        name: "थालीपीठ भाजिनी",
                        description: "पारंपरिक थालीपीठ के लिए मल्टीग्रेन आटा मिश्रण।",
                        image: "http://googleusercontent.com/img/thalipeeth-bhajani.jpg",
                        price: 110,
                        unit: "250ग्राम",
                        isNew: false
                    },
                    {
                        id: 7,
                        name: "पूरण पोली (मौसमी)",
                        description: "दाल के भरने के साथ मीठी रोटी, मौसमी रूप से उपलब्ध।",
                        image: "http://googleusercontent.com/img/puran-poli.jpg",
                        price: 35,
                        unit: "प्रति पीस",
                        isNew: false
                    },
                    {
                        id: 8,
                        name: "अम्बे दाल",
                        description: "कच्चे आम और चना दाल का सलाद।",
                        image: "http://googleusercontent.com/img/ambe-dal.jpg",
                        price: 70,
                        unit: "200ग्राम",
                        isNew: false
                    },
                ]
            },
            mr: {
                brandName: "कालिंदी - अंजली गृह उद्योग",
                pageTitle: "आता ऑर्डर करा - अंजली गृह उद्योग",
                backToHomeBtn: "होम पेजवर परत जा",
                viewCartBtn: "कार्ट पहा",
                cartTitle: "तुमचा कार्ट",
                totalAmountText: "एकूण:",
                continueShoppingBtn: "खरेदी सुरू ठेवा",
                proceedToCheckoutBtn: "चेकआउटसाठी पुढे जा",
                checkoutTitle: "चेकआउट तपशील",
                fullNameLabel: "पूर्ण नाव:",
                phoneLabel: "व्हॉट्सॲप फोन नंबर:",
                emailLabel: "ईमेल (पर्यायी):",
                addressLabel: "वितरण पत्ता:",
                deliveryInstructionsLabel: "वितरण सूचना (पर्यायी):",
                shippingMethodLabel: "शिपिंग पद्धत:",
                standardShippingText: "मानक शिपिंग (3-5 दिवस) - ₹50",
                expressShippingText: "एक्सप्रेस शिपिंग (1-2 दिवस) - ₹100",
                paymentMethodLabel: "पेमेंट पद्धत:",
                codText: "कॅश ऑन डिलिव्हरी (COD)",
                onlinePaymentText: "यूपीआय / ऑनलाइन पेमेंट",
                backToCartBtn: "कार्टवर परत जा",
                confirmOrderBtn: "व्हॉट्सॲपवर ऑर्डरची पुष्टी करा",
                removeBtn: "काढा",
                emptyCartMessage: "तुमचा कार्ट रिकामा आहे.",
                quantityLabel: "प्रमाण:",
                whatsappOrderSubject: "वेबसाइटवरून नवीन ऑर्डर",
                thankYouMessage: "आपल्या ऑर्डरबद्दल धन्यवाद! आम्ही लवकरच आपल्याशी संपर्क साधू.",
                productNotFound: "उत्पादन सापडले नाही.",
                products: [
                    {
                        id: 1,
                        name: "कोथिंबीर वडी (नवीन)",
                        description: "पारंपारिक महाराष्ट्रीयन स्नॅक, कुरकुरीत आणि स्वादिष्ट.",
                        image: "http://googleusercontent.com/img/kothambir-wadi.jpg",
                        price: 150,
                        unit: "250ग्रॅम",
                        isNew: true
                    },
                    {
                        id: 2,
                        name: "तिळगुळ लाडू",
                        description: "पारंपारिक तीळ आणि गुळाचा लाडू, सणांसाठी योग्य.",
                        image: "http://googleusercontent.com/img/tilgul-ladoo.jpg",
                        price: 200,
                        unit: "250ग्रॅम",
                        isNew: false
                    },
                    {
                        id: 3,
                        name: "बेसन लाडू",
                        description: "तोंडात विरघळणारी बेसनाची मिठाई.",
                        image: "http://googleusercontent.com/img/besan-ladoo.jpg",
                        price: 220,
                        unit: "250ग्रॅम",
                        isNew: false
                    },
                    {
                        id: 4,
                        name: "चिवडा",
                        description: "मसालेदार आणि कुरकुरीत स्नॅक मिक्स.",
                        image: "http://googleusercontent.com/img/chivda.jpg",
                        price: 180,
                        unit: "500ग्रॅम",
                        isNew: false
                    },
                    {
                        id: 5,
                        name: "शेव भाजी मसाला",
                        description: "शेव भाजीसाठी तयार मसाला मिश्रण.",
                        image: "http://googleusercontent.com/img/shev-bhaji-masala.jpg",
                        price: 90,
                        unit: "100ग्रॅम",
                        isNew: false
                    },
                    {
                        id: 6,
                        name: "थालीपीठ भाजिनी",
                        description: "पारंपारिक थालीपीठासाठी मल्टीग्रेन पिठाचे मिश्रण.",
                        image: "http://googleusercontent.com/img/thalipeeth-bhajani.jpg",
                        price: 110,
                        unit: "250ग्रॅम",
                        isNew: false
                    },
                    {
                        id: 7,
                        name: "पूरण पोळी (हंगामी)",
                        description: "डाळीच्या सारणाने भरलेली गोड पोळी, हंगामानुसार उपलब्ध.",
                        image: "http://googleusercontent.com/img/puran-poli.jpg",
                        price: 35,
                        unit: "प्रति पीस",
                        isNew: false
                    },
                    {
                        id: 8,
                        name: "आंबे डाळ",
                        description: "कच्च्या कैरी आणि चणा डाळीचे सॅलड.",
                        image: "http://googleusercontent.com/img/ambe-dal.jpg",
                        price: 70,
                        unit: "200ग्रॅम",
                        isNew: false
                    },
                ]
            }
        };

        function updateContent(lang) {
            translations = allTranslations[lang];

            document.getElementById('brandName').textContent = translations.brandName;
            document.getElementById('pageTitle').textContent = translations.pageTitle;
            document.getElementById('backToHomeBtn').textContent = translations.backToHomeBtn;
            document.getElementById('viewCartBtn').textContent = translations.viewCartBtn;
            document.getElementById('cartTitle').textContent = translations.cartTitle;
            document.getElementById('totalAmountText').textContent = translations.totalAmountText;
            document.getElementById('continueShoppingBtn').textContent = translations.continueShoppingBtn;
            document.getElementById('proceedToCheckoutBtn').textContent = translations.proceedToCheckoutBtn;
            document.getElementById('checkoutTitle').textContent = translations.checkoutTitle;
            document.getElementById('fullNameLabel').textContent = translations.fullNameLabel;
            document.getElementById('phoneLabel').textContent = translations.phoneLabel;
            document.getElementById('emailLabel').textContent = translations.emailLabel;
            document.getElementById('addressLabel').textContent = translations.addressLabel;
            document.getElementById('deliveryInstructionsLabel').textContent = translations.deliveryInstructionsLabel;
            document.getElementById('shippingMethodLabel').textContent = translations.shippingMethodLabel;
            document.getElementById('standardShippingText').textContent = translations.standardShippingText;
            document.getElementById('expressShippingText').textContent = translations.expressShippingText;
            document.getElementById('paymentMethodLabel').textContent = translations.paymentMethodLabel;
            document.getElementById('codText').textContent = translations.codText;
            document.getElementById('onlinePaymentText').textContent = translations.onlinePaymentText;
            document.getElementById('backToCartBtn').textContent = translations.backToCartBtn;
            document.getElementById('confirmOrderBtn').textContent = translations.confirmOrderBtn;
            // Update product list and cart display after language change
            displayProducts();
            updateCartDisplay();
        }


        function displayProducts() {
            const productListDiv = document.getElementById('productListSection');
            productListDiv.innerHTML = ''; // Clear existing products

            translations.products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white rounded-lg shadow-md overflow-hidden animate-slideInUp relative';
                productCard.innerHTML = `
                    ${product.isNew ? '<span class="absolute top-2 right-2 bg-heritage-500 text-white text-xs font-bold px-2 py-1 rounded-full">New</span>' : ''}
                    <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="text-xl font-bold text-gray-800">${product.name}</h3>
                        <p class="text-gray-600 text-sm mt-1">${product.description}</p>
                        <p class="text-heritage-600 font-bold text-lg mt-3">₹${product.price} / ${product.unit}</p>
                        <button onclick="addToCart(${product.id})" class="mt-4 bg-heritage-600 hover:bg-heritage-700 text-white font-bold py-2 px-4 rounded-full w-full transition duration-300 ease-in-out">Add to Cart</button>
                    </div>
                `;
                productListDiv.appendChild(productCard);
            });
        }

        function addToCart(productId) {
            const product = translations.products.find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartDisplay();
            } else {
                alert(translations[currentLanguage].productNotFound);
            }
        }

        function updateCartDisplay() {
            const cartItemsDiv = document.getElementById('cartItems');
            cartItemsDiv.innerHTML = '';
            let totalAmount = 0;

            if (cart.length === 0) {
                cartItemsDiv.innerHTML = `<p class="text-center text-gray-600">${translations[currentLanguage].emptyCartMessage}</p>`;
            } else {
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    totalAmount += itemTotal;

                    const cartItemDiv = document.createElement('div');
                    cartItemDiv.className = 'flex items-center justify-between bg-gray-50 p-3 rounded-lg shadow-sm';
                    cartItemDiv.innerHTML = `
                        <div class="flex items-center space-x-4">
                            <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-md">
                            <div>
                                <h4 class="font-bold text-gray-800">${item.name}</h4>
                                <p class="text-sm text-gray-600">${translations[currentLanguage].quantityLabel} ${item.quantity} x ₹${item.price}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <p class="font-bold text-heritage-600">₹${itemTotal}</p>
                            <button onclick="removeFromCart(${item.id})" class="text-red-500 hover:text-red-700 text-sm font-semibold" title="${translations[currentLanguage].removeBtn}">${translations[currentLanguage].removeBtn}</button>
                        </div>
                    `;
                    cartItemsDiv.appendChild(cartItemDiv);
                });
            }

            document.getElementById('totalAmount').textContent = totalAmount;
            document.getElementById('cartItemCount').textContent = cart.length; // Update count in header
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
        }

        function showCart() {
            document.getElementById('productListSection').classList.add('hidden');
            document.getElementById('checkoutSection').classList.add('hidden');
            document.getElementById('cartSection').classList.remove('hidden');
            updateCartDisplay(); // Ensure cart is updated when shown
        }

        function showCheckout() {
            if (cart.length === 0) {
                alert(translations[currentLanguage].emptyCartMessage);
                return;
            }
            document.getElementById('productListSection').classList.add('hidden');
            document.getElementById('cartSection').classList.add('hidden');
            document.getElementById('checkoutSection').classList.remove('hidden');
        }

        function cancelCheckout() {
            document.getElementById('checkoutSection').classList.add('hidden');
            document.getElementById('cartSection').classList.add('hidden'); // Ensure cart is also hidden if coming from checkout
            document.getElementById('productListSection').classList.remove('hidden');
        }

        document.getElementById('checkoutForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission
            confirmOrder();
        });

        function confirmOrder() {
            const fullName = document.getElementById('fullName').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const address = document.getElementById('address').value;
            const deliveryInstructions = document.getElementById('deliveryInstructions').value;
            const shippingMethod = document.querySelector('input[name="shipping"]:checked').value;
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            const totalOrderAmount = document.getElementById('totalAmount').textContent; // Get the total amount

            const whatsappNumber = '919604002702'; // Kalindi's WhatsApp number

            let orderDetails = `${translations[currentLanguage].whatsappOrderSubject}\\n\\n`;
            orderDetails += `${translations[currentLanguage].fullNameLabel} ${fullName}\\n`;
            orderDetails += `${translations[currentLanguage].phoneLabel} ${phone}\\n`;
            if (email) orderDetails += `${translations[currentLanguage].emailLabel} ${email}\\n`;
            orderDetails += `${translations[currentLanguage].addressLabel} ${address}\\n`;
            if (deliveryInstructions) orderDetails += `${translations[currentLanguage].deliveryInstructionsLabel} ${deliveryInstructions}\\n`;
            orderDetails += `${translations[currentLanguage].shippingMethodLabel} ${shippingMethod}\\n\\n`;
            orderDetails += `${translations[currentLanguage].cartTitle}:\\n`;

            cart.forEach(item => {
                orderDetails += `- ${item.name} (${item.unit}) x ${item.quantity} = ₹${item.price * item.quantity}\\n`;
            });

            orderDetails += `\\n${translations[currentLanguage].totalAmountText} ₹${totalOrderAmount}\\n`;
            orderDetails += `${translations[currentLanguage].paymentMethodText} ${paymentMethod}\\n`;

            // Encode message for URL
            const encodedMessage = encodeURIComponent(orderDetails);
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;

            // Redirect to WhatsApp
            window.open(whatsappUrl, '_blank');

            // Clear cart and show success message (optional, as user is redirected)
            alert(translations[currentLanguage].thankYouMessage);
            cart = [];
            localStorage.removeItem('cart');
            updateCartDisplay();
            cancelCheckout(); // Go back to product list view
        }


        // On page load
        document.addEventListener('DOMContentLoaded', () => {
            // Get language from localStorage (set by home page)
            currentLanguage = localStorage.getItem('selectedLanguage') || 'en';
            updateContent(currentLanguage);
            document.getElementById('currentYear').textContent = new Date().getFullYear();

            // Listen for language changes
            window.addEventListener('storage', (e) => {
                if (e.key === 'selectedLanguage') {
                    currentLanguage = e.newValue || 'en';
                    updateContent(currentLanguage);
                }
            });
        });
    </script>
</body>
</html>
